# Zrealizowane działania portu macOS

- Utworzono moduł `Platform/PathProvider` zapewniający wieloplatformową obsługę katalogów użytkownika (AppData/Application Support) oraz narzędzie `ensureDirectoryExists` do bezpiecznego tworzenia struktur katalogów.
- Zastąpiono w `NppParameters` bezpośrednie odwołania do `SHGetFolderPath` i ręcznych wywołań `CreateDirectory` integracją z nowym modułem platformowym i przygotowano fallbacki dla środowiska macOS.
- Dostosowano `PluginsAdmin` oraz testowy kod `FunctionList` do korzystania z nowego interfejsu ścieżek, ograniczając dalsze zależności od stałych `CSIDL` i przygotowując grunt pod kompilację poza Windows.
- Opracowano dokument `docs/macos/architecture_assessment.md` klasyfikujący moduły PowerEditor, Scintilla i Lexilla pod kątem przenośności oraz mapujący zależności od Win32 na odpowiedniki macOS wraz z analizą ryzyk dla portu; zadania w sekcji analitycznej planu zostały zaktualizowane jako ukończone.
- Opracowano dokument `docs/macos/build_system_plan.md` opisujący podział projektów CMake, cele platformowe (Windows/macOS), plan tworzenia pakietu `.app` oraz integrację CI, jednocześnie potwierdzając dostępność backendu Cocoa w Scintilli i neutralny platformowo kod Lexilli.
- Dodano moduł `Platform/FileSystem` zapewniający wieloplatformowe operacje na ścieżkach (łączenie, weryfikacja i usuwanie plików/katalogów) oraz włączono go do konfiguracji CMake i projektu Visual Studio.
- Przebudowano obsługę katalogu chmury w `NppParameters`, zastępując bezpośrednie wywołania WinAPI nowym API platformowym `combinePath`, `ensureDirectoryExists`, `fileExists` i `removeFile`, aby ujednolicić przygotowanie ścieżek pod macOS.
- Przygotowano dokument `docs/macos/ui_strategy.md` porównujący Cocoa i toolkity wieloplatformowe oraz opisujący plan migracji UI z warstwą abstrakcji `npp::ui` i mostkami eventów.
- Opracowano roadmapę `docs/macos/port_roadmap.md` z fazami iteracyjnego portu, kamieniami milowymi i wskaźnikami jakości, aktualizując plan `macOS_convert_todo.md` o zakończone zadanie harmonogramu.
- Zrefaktoryzowano tworzenie katalogów w `Buffer.cpp`, `Notepad_plus.cpp`, `Notepad_plus_Window.cpp` i `NppIO.cpp`, zastępując wywołania WinAPI funkcjami `npp::platform::ensureDirectoryExists` i `combinePath`, aby przygotować kod do budowy poza Windows.
- Uaktualniono strategię UI w `docs/macos/ui_strategy.md`, wybierając Qt 6.x z motywem Liquid Glass jako warstwę prezentacji oraz dodając nowe zadania w `macOS_convert_todo.md` dotyczące modułu `npp::ui` i prototypu Qt.
- Rozszerzono moduł `Platform/PathProvider` o katalog tymczasowy (`KnownDirectory::Temporary`) i zintegrowano go z logiką zapisu w `Buffer.cpp`, eliminując bezpośrednie wywołania `GetTempPath` oraz zastępując obliczanie znaczników czasu implementacją w `std::chrono` zgodną z macOS.
- Przygotowano dokument `docs/macos/system_services_matrix.md` mapujący zależności Win32 na odpowiedniki w macOS wraz ze strategią użycia w warstwie `npp::platform` i priorytetami integracji.
- Stworzono przewodnik `docs/macos/developer_environment.md` opisujący wymagane narzędzia, konfigurację repozytorium, procedurę bootstrap i walidację jakości dla zespołu pracującego nad portem macOS; oznaczono odpowiadające zadania w planie jako wykonane.
- Zaktualizowano `README.md`, aby przedstawić repozytorium jako projekt portu Notepad++ na macOS, podkreślając strategię UI/UX, dokumentację oraz wymogi jakościowe i testowe.
- Przebudowano obsługę awaryjnego zapisu w `winmain.cpp`, korzystając z `npp::platform::pathFor`, `combinePath` i `ensureDirectoryExists` zamiast `GetTempPath`, aby mechanizm odzyskiwania dokumentów działał na macOS i innych systemach.
- Wprowadzono konfigurację testów jednostkowych Catch2 (`tests/unit/CMakeLists.txt`) oraz pierwszy pakiet testów dla modułu platformowego (`tests/unit/platform/test_path_provider.cpp`), zapewniając walidację operacji na ścieżkach i plikach niezależnie od systemu operacyjnego.
- Skonfigurowano workflow GitHub Actions `macOS Port CI` uruchamiający budowę i testy modułów platformowych na hostach macOS, wprowadzając automatyczną walidację cross-platform oraz aktualizując plan działań o kolejne etapy publikacji pakietów `.app`.
- Utworzono moduł `Platform/SettingsLocator` określający katalogi ustawień i wtyczek z wykorzystaniem `PathProvider`, aby kierować macOS na `~/Library/Application Support/Notepad++`, oraz zrefaktoryzowano `NppParameters::load()` do korzystania z nowych ścieżek z walidacją tworzenia katalogów.
- Dodano testy jednostkowe `test_settings_locator.cpp` w pakiecie platformowym weryfikujące scenariusze lokalnej i użytkownika macOS, rozszerzając konfigurację CMake/Visual Studio o nowy moduł oraz oznaczono zadanie planu konfiguracji preferencji jako ukończone.
- Rozszerzono moduł `Platform/FileSystem` o funkcje `fileSize` i `copyFile`, zrefaktoryzowano logikę `NppParameters` do korzystania z nich zamiast `CopyFile` oraz dodano testy jednostkowe weryfikujące kopiowanie i raportowanie rozmiarów plików niezależnie od platformy.
- Utworzono katalog `PowerEditor/macos` z konfiguracją CMake i natywnym szkieletem Cocoa generującym pakiet `NotepadPlusPlusPreview.app`, aby potwierdzić przepływ budowy przyszłego UI Liquid Glass na macOS.
- Przebudowano workflowi CI: ograniczono publikację artefaktów Windows do wydań tagowanych oraz dodano w `macOS Port CI` kroki budowy i archiwizacji podglądowego pakietu `.app`, co zamyka zadanie rozbudowy pipeline macOS o dystrybucję.
- Utworzono moduł `Platform/SystemInfo` dostarczający informacje o systemie i wyświetlaczach niezależnie od platformy oraz zrefaktoryzowano `DebugInfoDlg`, aby korzystał z tej warstwy zamiast bezpośrednich wywołań WinAPI, przygotowując fallback dla macOS.

- Opracowano plan migracji preferencji w dokumencie `docs/macos/registry_migration_plan.md`, mapując klucze rejestru Windows na preferencje macOS, definiując interfejs `PreferencesStore`, migratory oraz wymagania testowe; odpowiednie zadanie w planie oznaczono jako ukończone i dodano kolejne etapy implementacji.
